# Spark worker Dockerfile
FROM apache/spark:3.5.0-python3

USER root

# Install additional Python packages
RUN pip install --no-cache-dir \
    pyspark==3.5.0 \
    delta-spark==3.0.0 \
    pyarrow==14.0.1 \
    pandas==2.1.3 \
    numpy==1.26.2 \
    scikit-learn==1.3.2

# Copy application code
COPY src/meridian/infrastructure/spark /opt/spark/work-dir/meridian/spark

WORKDIR /opt/spark/work-dir

USER spark

